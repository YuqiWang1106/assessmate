{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Take Assessment</title>
    <!-- 与 create_assessment 完全相同的CSS -->
    <link rel="stylesheet" href="{% static 'css/create_assessment.css' %}">
    <!-- Bootstrap 可选 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
          rel="stylesheet" 
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
          crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
            crossorigin="anonymous"></script>

    <!-- 依旧用同一个 create_assessment.js，保证交互一致 -->
    <script src="{% static 'js/student_assessment.js' %}"></script>
    
    <!-- 强制设 READ_ONLY=false，这样radio可选、open题文本框可编辑（若你想改成只读，可改true） -->
    <script>
        var READ_ONLY = "false";
    </script>
</head>
<body class="create-body">
    <div class="create-container">
        <h1 class="create-page-title">Take Assessment</h1>

        <!--
          可以根据需要保留或移除这一区域。
          因为学生不用“Publish”，所以隐藏掉即可。
        -->
        <!--
        <div class="create-top-btns">
            老师才需要的按钮，已注释掉 
            <button class="create-btn purple-btn">Publish</button>
        </div>
        -->

        <!-- form 保留，以便将来扩展提交功能 -->
        <form id="assessment-form" method="POST">
            {% csrf_token %}
            <div class="create-title-input-box">
                <!-- 标题可只读，也可让学生看到课程标题 or 评估标题 -->
                <input
                    type="text"
                    id="assessment-title"
                    class="create-title-input"
                    name="assessment_title"
                    placeholder="Assessment Title"
                    value="{{ assessment.title|default_if_none:'Assessment Title' }}"
                    disabled
                />
            </div>

            <!-- 问题列表，根据 questions_json 动态注入 -->
            <div id="question-list" class="create-question-list">
            </div>

            <!-- 这里放一个“Submit”按钮即可，其他 teacher 专属按钮都注释掉 -->
            <div class="create-button-group" style="text-align: right;">
                <button type="button" class="create-btn purple-btn">
                    Submit
                </button>
            </div>
            
            <!-- 如果需要，可以存一些隐藏域信息(学生ID / 课程ID / assessmentID) -->
            <input type="hidden" id="student-id" value="{{ student.id }}">
            <input type="hidden" id="course-id" value="{{ course.id }}">
            <input type="hidden" id="assessment-id" value="{{ assessment.id }}">
            <input type="hidden" id="target-user-id" value="{{ target_user.id }}">
            
        </form>

        <!-- 下列所有Modals都是给老师编辑用的，这里可直接不需要。若真要“保持完全相同”，可保留UI，但对学生端没用 -->
        <!--
        <div id="question-modal" class="create-modal">
            <h3>Select Question Type</h3>
            <select id="question-type" class="create-select">
                <option value="likert">Likert Scale</option>
                <option value="open">Open-Ended</option>
            </select>
            <br><br>
            <button onclick="confirmAddQuestion()">Confirm</button>
            <button onclick="closeModal()">Cancel</button>
        </div>

        <div id="publish-modal" class="create-modal">
            <h3>Select Due Date</h3>
            <input type="date" id="due-date" />
            <br><br>
            <button>OK</button>
            <button>Cancel</button>
        </div>

        <div id="quit-modal" class="create-modal">
            <h3>Are you sure you want to quit?</h3>
            <p>You can save your changes or discard them.</p>
            <button>Save & Quit</button>
            <button>Quit Anyway</button>
        </div>
        
        <div id="delete-modal" class="create-modal">
            <h3>Are you sure you want to delete this assessment?</h3>
            <p>This action cannot be undone.</p>
            <button>Yes, Delete</button>
            <button>Cancel</button>
        </div>
        -->
        
        <!-- 传入题目信息(JSON)，和 create_assessment 一样的逻辑 -->
        <script id="preloaded-questions" type="application/json">
            {{ questions_json|safe }}
        </script>
    </div>
</body>
</html>
